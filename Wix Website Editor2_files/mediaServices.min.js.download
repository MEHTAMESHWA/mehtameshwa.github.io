define("mediaServices/services/wixMediaManager/constants",["util"],function(a){"use strict";return{BASE_HOST:a.serviceTopology.baseDomain,MMGR_BASE_URL:a.serviceTopology.mediaManagerUrl,MMGR_UOU_UPLOAD_NAMESPACE:"_WixCodeAnonymUpload",MMGR_LANGUAGE_CODE:a.editorModel.languageCode,MMGR_WINDOW_STYLE:"fullscreen",MMGR_SELECTION_TYPE:["single","multiple"],MMGR_TRANSLATION_KEYS_MAP:{description:{private:"private_media.upload_restrictions_header_message",external:"social_images.upload_restrictions_header_message",public:"free_from_wix.upload_restrictions_header_message",photoStock:"bigstock_images.upload_restrictions_header_message"},tab:{private:"private_media_tab",external:"external_media_tab",public:"public_media_tab",photoStock:"photo_stock_tab"},noItems:{allMediaFolder:{header:"no_items.header_allMedia",text:"no_items.text_allMedia"},siteMediaFolder:{header:"no_items.header_siteMedia",text:"no_items.text_siteMedia"},userMediaFolder:{header:"no_items.header_user_folder",text:"no_items.text_user_folder"}},title:"header",submitButton:"footer.submit",uploadButton:"uploader.upload"},MMGR_SERVICES_LIST_MAP:{FACEBOOK:"facebook",FLICKR:"flickr",INSTAGRAM:"instagram",PICASA:"picasa",GOOGLE_DRIVE:"drive",DROPBOX:"dropbox"},SINGLE:0,MULTIPLE:1,PRIVATE_MEDIA:"private",MMGR_TABS_MAP:{MY_SHAPE:"private",MY_SHAPE_UOU:"private",MY_IMAGE:"private",MY_IMAGE_PRO:"private",MY_IMAGE_UOU:"private",MY_VIDEO:"private",MY_VIDEO_PRO:"private",MY_VIDEO_UOU:"private",MY_MUSIC:"private",MY_MUSIC_PRO:"private",MY_MUSIC_UOU:"private",MY_DOCUMENT:"private",MY_DOCUMENT_PRO:"private",MY_DOCUMENT_UOU:"private",MY_FLASH:"private",MY_FLASH_UOU:"private",MY_FAVICON:"private",MY_NETWORK:"external",FREE_FROM_WIX:"public",BIG_STOCK:"photoStock"}}});define("mediaServices/services/wixMediaManager/presets",["mediaServices/services/wixMediaManager/constants"],function(a){"use strict";return{SHAPE:{canAddMedia:true,canAddMultipleMedia:true,canAddMediaBeforeEncodingComplete:false,canUploadMedia:false,tabsList:{open:["FREE_FROM_WIX"],manage:[],default:"FREE_FROM_WIX"},socialNetworksList:[],mmgrParams:{i18nPrefix:["shape","multiple_shapes"],mediaType:"shape",publicMediaRoot:"shapes",videoEncodingProfile:"",namespace:""},translationMap:{title:true,tabCaption:false,description:true,uploadCaption:true,noItems:false,submitCaption:true}},IMAGE:{canAddMedia:true,canAddMultipleMedia:true,canAddMediaBeforeEncodingComplete:false,canUploadMedia:true,tabsList:{open:["MY_IMAGE","MY_NETWORK","FREE_FROM_WIX","BIG_STOCK"],manage:["MY_IMAGE"],default:"MY_IMAGE"},socialNetworksList:["FACEBOOK","INSTAGRAM","DROPBOX","GOOGLE_DRIVE","FLICKR","PICASA"],mmgrParams:{i18nPrefix:["single_image","multiple_images"],mediaType:"picture",publicMediaRoot:"photos",videoEncodingProfile:"",namespace:""},translationMap:{title:true,tabCaption:false,description:true,uploadCaption:true,noItems:false,submitCaption:true}},IMAGE_PRO:{canAddMedia:true,canAddMultipleMedia:true,canAddMediaBeforeEncodingComplete:false,canUploadMedia:true,tabsList:{open:["MY_IMAGE_PRO"],manage:["MY_IMAGE_PRO"],default:"MY_IMAGE_PRO"},socialNetworksList:[],mmgrParams:{i18nPrefix:["single_secure_image","addmultiple_secure_images"],mediaType:"secure_picture",publicMediaRoot:"",videoEncodingProfile:"",namespace:""},translationMap:{title:true,tabCaption:false,description:true,uploadCaption:true,noItems:false,submitCaption:true}},IMAGE_UOU:{canAddMedia:false,canAddMultipleMedia:false,canAddMediaBeforeEncodingComplete:false,canUploadMedia:false,tabsList:{open:["MY_IMAGE_UOU"],manage:["MY_IMAGE_UOU"],default:"MY_IMAGE_UOU"},socialNetworksList:[],mmgrParams:{i18nPrefix:["single_image","multiple_images"],mediaType:"picture",publicMediaRoot:"",videoEncodingProfile:"",namespace:a.MMGR_UOU_UPLOAD_NAMESPACE},translationMap:{title:true,tabCaption:true,description:true,uploadCaption:false,noItems:true,submitCaption:false}},DOCUMENT_UOU:{canAddMedia:false,canAddMultipleMedia:false,canAddMediaBeforeEncodingComplete:false,canUploadMedia:false,tabsList:{open:["MY_DOCUMENT_UOU"],manage:["MY_DOCUMENT_UOU"],default:"MY_DOCUMENT_UOU"},socialNetworksList:[],mmgrParams:{i18nPrefix:["document","addmultiple_document"],mediaType:"document",publicMediaRoot:"",videoEncodingProfile:"",namespace:a.MMGR_UOU_UPLOAD_NAMESPACE},translationMap:{title:true,tabCaption:true,description:true,uploadCaption:false,noItems:true,submitCaption:false}},VIDEO:{canAddMedia:true,canAddMultipleMedia:false,canAddMediaBeforeEncodingComplete:true,canUploadMedia:true,tabsList:{open:["MY_VIDEO"],manage:["MY_VIDEO"],default:"MY_VIDEO"},socialNetworksList:[],mmgrParams:{i18nPrefix:["video","addmultiple_video"],mediaType:"video",publicMediaRoot:"",videoEncodingProfile:"mp4-storyboard",namespace:""},translationMap:{title:true,tabCaption:false,description:true,uploadCaption:true,noItems:false,submitCaption:true}},MUSIC:{canAddMedia:true,canAddMultipleMedia:true,canAddMediaBeforeEncodingComplete:false,canUploadMedia:true,tabsList:{open:["MY_MUSIC"],manage:["MY_MUSIC"],default:"MY_MUSIC"},socialNetworksList:[],mmgrParams:{i18nPrefix:["music","addmultiple_music"],mediaType:"music",publicMediaRoot:"",videoEncodingProfile:"",namespace:""},translationMap:{title:true,tabCaption:false,description:true,uploadCaption:true,noItems:false,submitCaption:true}},MUSIC_PRO:{canAddMedia:true,canAddMultipleMedia:true,canAddMediaBeforeEncodingComplete:false,canUploadMedia:true,tabsList:{open:["MY_MUSIC_PRO"],manage:["MY_MUSIC_PRO"],default:"MY_MUSIC_PRO"},socialNetworksList:[],mmgrParams:{i18nPrefix:["secure_music","addmultiple_secure_music"],mediaType:"secure_music",publicMediaRoot:"",videoEncodingProfile:"",namespace:""},translationMap:{title:true,tabCaption:false,description:true,uploadCaption:true,noItems:false,submitCaption:true}},DOCUMENT:{canAddMedia:true,canAddMultipleMedia:true,canAddMediaBeforeEncodingComplete:false,canUploadMedia:true,tabsList:{open:["MY_DOCUMENT"],manage:["MY_DOCUMENT"],default:"MY_DOCUMENT"},socialNetworksList:[],mmgrParams:{i18nPrefix:["document","addmultiple_document"],mediaType:"document",publicMediaRoot:"",videoEncodingProfile:"",namespace:""},translationMap:{title:true,tabCaption:false,description:true,uploadCaption:true,noItems:false,submitCaption:true}},FLASH:{canAddMedia:true,canAddMultipleMedia:false,canAddMediaBeforeEncodingComplete:false,canUploadMedia:true,tabsList:{open:["MY_FLASH"],manage:[],default:"MY_FLASH"},socialNetworksList:[],mmgrParams:{i18nPrefix:["flash","multiple_flash"],mediaType:"swf",publicMediaRoot:"",videoEncodingProfile:"",namespace:""},translationMap:{title:true,tabCaption:false,description:true,uploadCaption:true,noItems:false,submitCaption:true}},CLIPART:{canAddMedia:true,canAddMultipleMedia:false,canAddMediaBeforeEncodingComplete:false,canUploadMedia:true,tabsList:{open:["MY_IMAGE","MY_NETWORK","FREE_FROM_WIX","BIG_STOCK"],manage:[],default:"MY_IMAGE"},socialNetworksList:["FACEBOOK","INSTAGRAM","DROPBOX","GOOGLE_DRIVE","FLICKR","PICASA"],mmgrParams:{i18nPrefix:["clipart","addmultiple_clipart"],mediaType:"picture",publicMediaRoot:"clipart",videoEncodingProfile:"",namespace:""},translationMap:{title:true,tabCaption:false,description:true,uploadCaption:true,noItems:false,submitCaption:true}},BG_IMAGE:{canAddMedia:true,canAddMultipleMedia:false,canAddMediaBeforeEncodingComplete:false,canUploadMedia:true,tabsList:{open:["MY_IMAGE","MY_NETWORK","FREE_FROM_WIX","BIG_STOCK"],manage:[],default:"MY_IMAGE"},socialNetworksList:["FACEBOOK","INSTAGRAM","DROPBOX","GOOGLE_DRIVE","FLICKR","PICASA"],mmgrParams:{i18nPrefix:["background","multiple_background"],mediaType:"picture",publicMediaRoot:"backgrounds",videoEncodingProfile:"",namespace:""},translationMap:{title:true,tabCaption:false,description:true,uploadCaption:true,noItems:false,submitCaption:true}},BG_VIDEO:{canAddMedia:true,canAddMultipleMedia:false,canAddMediaBeforeEncodingComplete:true,canUploadMedia:true,tabsList:{open:["MY_VIDEO","FREE_FROM_WIX"],manage:[],default:"MY_VIDEO"},socialNetworksList:[],mmgrParams:{i18nPrefix:["video","addmultiple_video"],mediaType:"video",publicMediaRoot:"videos",videoEncodingProfile:"mp4-storyboard",namespace:""},translationMap:{title:true,tabCaption:false,description:true,uploadCaption:true,noItems:false,submitCaption:true}},ICON_DOCUMENT:{canAddMedia:true,canAddMultipleMedia:false,canAddMediaBeforeEncodingComplete:false,canUploadMedia:true,tabsList:{open:["MY_IMAGE","MY_NETWORK","FREE_FROM_WIX","BIG_STOCK"],manage:[],default:"FREE_FROM_WIX"},socialNetworksList:["FACEBOOK","INSTAGRAM","DROPBOX","GOOGLE_DRIVE","FLICKR","PICASA"],mmgrParams:{i18nPrefix:["single_icon","multiple_icons"],mediaType:"picture",publicMediaRoot:"file_icons",videoEncodingProfile:"",namespace:""},translationMap:{title:true,tabCaption:false,description:true,uploadCaption:true,noItems:false,submitCaption:true}},ICON_SOCIAL:{canAddMedia:true,canAddMultipleMedia:true,canAddMediaBeforeEncodingComplete:false,canUploadMedia:true,tabsList:{open:["MY_IMAGE","MY_NETWORK","FREE_FROM_WIX","BIG_STOCK"],manage:[],default:"FREE_FROM_WIX"},socialNetworksList:["FACEBOOK","INSTAGRAM","DROPBOX","GOOGLE_DRIVE","FLICKR","PICASA"],mmgrParams:{i18nPrefix:["single_icon","multiple_icons"],mediaType:"picture",publicMediaRoot:"social_icons",videoEncodingProfile:"",namespace:""},translationMap:{title:true,tabCaption:false,description:true,uploadCaption:true,noItems:false,submitCaption:true}},ICON_FAVICON:{canAddMedia:true,canAddMultipleMedia:false,canAddMediaBeforeEncodingComplete:false,canUploadMedia:true,tabsList:{open:["MY_FAVICON","BIG_STOCK"],manage:[],default:"MY_FAVICON"},socialNetworksList:[],mmgrParams:{i18nPrefix:["favicon","multiple_favicons"],mediaType:"site_icon",publicMediaRoot:"",videoEncodingProfile:"",namespace:""},translationMap:{title:true,tabCaption:false,description:true,uploadCaption:true,noItems:false,submitCaption:true}}}});define("mediaServices/services/wixMediaManager/mmgrUtils",["lodash","mediaServices/services/wixMediaManager/constants","util"],function(a,b,c){"use strict";function d(a){return a.mmgrParams.mediaType}function e(a){return b.MMGR_SELECTION_TYPE[a.canAddMultipleMedia?b.MULTIPLE:b.SINGLE]}function f(a){var c=a.mmgrParams.i18nPrefix;return c[a.canAddMultipleMedia?b.MULTIPLE:b.SINGLE]}function g(a){var b=[];for(var c=0;c<a.tabsList.length;c++){b[c]=h(a.tabsList[c])}return b}function h(a){return b.MMGR_TABS_MAP[a]}function i(a){var c=[];for(var d=0;d<a.socialNetworksList.length;d++){c[d]=b.MMGR_SERVICES_LIST_MAP[a.socialNetworksList[d]]}return c}function j(d){var e={};var f,g;var i=d.canAddMultipleMedia?"_MULTISELECT":"";if(d.translationMap.title){f=("MMGR_API_"+d.categoryName+(d.manageMode?"_MANAGE":"_OPEN")+"_TITLE"+i).toUpperCase();g=b.MMGR_TRANSLATION_KEYS_MAP.title;e[g]=d.translation.title||c.translate(f)}a.forEach(d.tabsList,function(a){if(d.translationMap.tabCaption){f=("MMGR_API_"+a+"_TAB").toUpperCase();g=b.MMGR_TRANSLATION_KEYS_MAP.tab[h(a)];e[g]=c.translate(f)}if(d.translationMap.description){f=("MMGR_API_"+a+"_DESCRIPTION").toUpperCase();g=b.MMGR_TRANSLATION_KEYS_MAP.description[h(a)];e[g]=c.translate(f)}if(h(a)===b.PRIVATE_MEDIA&&d.translationMap.noItems){f=("MMGR_API_"+a+"_NO_ITEMS_HEADER_ALL_MEDIA").toUpperCase();g=b.MMGR_TRANSLATION_KEYS_MAP.noItems.allMediaFolder.header;e[g]=c.translate(f);f=("MMGR_API_"+a+"_NO_ITEMS_TEXT_ALL_MEDIA").toUpperCase();g=b.MMGR_TRANSLATION_KEYS_MAP.noItems.allMediaFolder.text;e[g]=c.translate(f);f=("MMGR_API_"+a+"_NO_ITEMS_HEADER_SITE_MEDIA").toUpperCase();g=b.MMGR_TRANSLATION_KEYS_MAP.noItems.siteMediaFolder.header;e[g]=c.translate(f);f=("MMGR_API_"+a+"_NO_ITEMS_TEXT_SITE_MEDIA").toUpperCase();g=b.MMGR_TRANSLATION_KEYS_MAP.noItems.siteMediaFolder.text;e[g]=c.translate(f);f=("MMGR_API_"+a+"_NO_ITEMS_HEADER_USER_FOLDER").toUpperCase();g=b.MMGR_TRANSLATION_KEYS_MAP.noItems.userMediaFolder.header;e[g]=c.translate(f);f=("MMGR_API_"+a+"_NO_ITEMS_TEXT_USER_FOLDER").toUpperCase();g=b.MMGR_TRANSLATION_KEYS_MAP.noItems.userMediaFolder.text;e[g]=c.translate(f)}});if(d.translationMap.uploadCaption){f=("MMGR_API_"+d.categoryName+"_UPLOAD_BUTTON").toUpperCase();g=b.MMGR_TRANSLATION_KEYS_MAP.uploadButton;e[g]=c.translate(f)}if(d.translationMap.submitCaption){f=("MMGR_API_"+d.categoryName+"_SUBMIT_BUTTON"+i).toUpperCase();g=b.MMGR_TRANSLATION_KEYS_MAP.submitButton;e[g]=d.translation.submitButton||c.translate(f)}return e}return{getMMGRMediaType:d,getMMGRSelectionType:e,getMMGRI18nPrefix:f,getMMGRTabsList:g,getMMGRServicesList:i,getMMGRTranslations:j}});define("mediaServices/services/wixMediaManager/adapter",["lodash","jquery","mediaServices/services/wixMediaManager/presets","mediaServices/services/wixMediaManager/constants","mediaServices/services/wixMediaManager/mmgrUtils","pLoader!santa:utils"],function(a,b,c,d,e,f){"use strict";function g(b,e,g){g=g||{};var h=c[e];var j={categoryName:e,tabsList:h.tabsList.manage,socialNetworksList:h.socialNetworksList,mmgrParams:h.mmgrParams,canAddMedia:false,canAddMultipleMedia:false,canAddMediaBeforeEncodingComplete:false,canUploadMedia:h.canUploadMedia,manageMode:true,path:g.path||d.MMGR_TABS_MAP[h.tabsList.default],translation:{},translationMap:h.translationMap,siteMediaToken:b.siteMediaToken,isEmailWithWixDomain:b.isEmailWithWixDomain};if(g.translation){if(g.translation.title){j.translation.title=g.translation.title}}if(g.callback){j.callback=g.callback}if(a.isEmpty(j.tabsList)){f.log.error(e+" is an un-managed category")}else{i(j)}}function h(a,b,e){e=e||{};var f=c[b];var g={categoryName:b,tabsList:f.tabsList.open,socialNetworksList:f.socialNetworksList,mmgrParams:f.mmgrParams,canAddMedia:f.canAddMedia,canAddMultipleMedia:e.multiSelect===undefined?f.canAddMultipleMedia:e.multiSelect,canAddMediaBeforeEncodingComplete:f.canAddMediaBeforeEncodingComplete,canUploadMedia:f.canUploadMedia,manageMode:false,path:e.path||d.MMGR_TABS_MAP[f.tabsList.default],translation:{},translationMap:f.translationMap,siteMediaToken:a.siteMediaToken,isEmailWithWixDomain:a.isEmailWithWixDomain};if(e.translation){if(e.translation.title){g.translation.title=e.translation.title}if(e.translation.submitButton){g.translation.submitButton=e.translation.submitButton}}if(e.callback){g.callback=function(){e.callback.apply(null,arguments);window.focus()}}i(g)}function i(b){var c=l();var f={mediaGalleryBaseHost:d.MMGR_BASE_URL,baseHost:d.BASE_HOST,i18nCode:d.MMGR_LANGUAGE_CODE,windowStyle:d.MMGR_WINDOW_STYLE,i18nPrefix:e.getMMGRI18nPrefix(b),mediaType:e.getMMGRMediaType(b),selectionType:e.getMMGRSelectionType(b),canShowSelectButton:b.canAddMedia,canSubmitUntranscoded:b.canAddMediaBeforeEncodingComplete,disableUpload:!b.canUploadMedia,tabsList:e.getMMGRTabsList(b),path:b.path,siteMediaToken:b.siteMediaToken,isEmailWithWixDomain:b.isEmailWithWixDomain};f.translations=e.getMMGRTranslations(b);if(b.mmgrParams.publicMediaRoot){f.publicMediaRoot=b.mmgrParams.publicMediaRoot}if(!a.isEmpty(b.socialNetworksList)){f.servicesList=e.getMMGRServicesList(b)}if(!a.isEmpty(b.mmgrParams.videoEncodingProfile)){f.videoEncodingProfile=b.mmgrParams.videoEncodingProfile}if(!a.isEmpty(b.mmgrParams.namespace)){f.namespace=b.mmgrParams.namespace}function g(a){if(b.callback){var d=a&&a.items||null;var e=d&&{path:a.path}||null;b.callback(d,e)}c.off("close",g);c.off("items",g);j()}c.on("items",g).on("close",g);c.open(f);window.document.getElementById("mediaGalleryFrame").contentWindow.focus()}function j(){var a=b("#editor");if(a){var c=b(window);var d=c.scrollTop();a.trigger("focus");c.scrollTop(d)}}function k(){var b={};a.forEach(a.keys(c),function(a){a=a.toUpperCase();b[a]=a});return b}function l(){return window.MediaFrame}return{open:h,presets:c,manage:g,categories:k()}});define("mediaServices/services/fontsManager/fontsUploader",["lodash","wixmp","util"],function(a,b,c){"use strict";function d(d,e){if(d){var f=a.map(e,function(a){return{uploadFn:d.item.upload,source:{file:a,name:a.name,size:a.size,folderId:null,folderName:"All Media",mediaType:c.fontsManagerUtils.constants.FONTS_MEDIA_TYPE}}});b.Uploader.upload(f)}}function e(a){b.Uploader.on("fileStatusChanged",function(b){a(b)})}function f(a){b.Uploader.on("queueChanged",function(b){a(b)})}function g(){if(!b.Uploader.uploadIsInProgress){b.Uploader.clearQueue()}}function h(){return b.Uploader.uploadQueue}function i(a){var b=false;if(a.canAbort()){try{a.abort();b=true}catch(a){b=false}}return b}function j(){if(!a.isEmpty(b.Uploader.uploadQueue)&b.Uploader.uploadIsInProgress){b.Uploader.upload()}}return{upload:d,clearUploadQueue:g,getUploadQueue:h,cancelUpload:i,retryUpload:j,registerToFileStatusChanged:e,registerToQueueChange:f}});define("mediaServices/services/fontsManager/fontsManager",["lodash","wixmp","util","mediaServices/services/fontsManager/fontsUploader","experiment"],function(a,b,c,d,e){"use strict";var f=new b.Source(b.sources.PRIVATE);if(e.isOpen("fontsUploadAsync")){f=new b.Source(b.sources.PRIVATE,{asyncFontUpload:true})}var g={};var h={};var i=c.fontsManagerUtils.constants;function j(b){b=a.reject(b,function(a){return!a.fileInput});return a.map(b,function(a){return c.fontsManagerUtils.getUploadedFontData(a)})}function k(){l();d.registerToFileStatusChanged(p);d.registerToQueueChange(q);s()}function l(){return f.items.list(null,{mediaType:i.FONTS_MEDIA_TYPE}).then(function(a){h=j(a.data);m(i.FONT_EVENTS_NAMES.LIST_CHANGED,h)})}function m(b,c){a.forEach(g[b],function(a){a(c)})}function n(a,b){if(g[a]){g[a].push(b)}else{g[a]=[b]}}function o(b,c){g[b]=a.reject(g[b],function(a){return a===c})}function p(a){if(a.currentFileProgress.status===i.FONT_STATUS.SUCCEEDED){l()}m(i.FONT_EVENTS_NAMES.FILE_CHANGED,a)}function q(a){m(i.FONT_EVENTS_NAMES.QUEUE_CHANGED,a)}function r(){return h}function s(){b.events.on(b.events.ITEMS.REMOVE,function(b){a.forEach(b,function(a){a.then(l).catch()})})}function t(a){f.items.remove(a)}function u(a){d.upload(f,a)}return{registerObserver:n,unregisterObserver:o,getList:r,remove:t,init:k,uploader:{upload:u,clearUploadQueue:d.clearUploadQueue,getUploadQueue:d.getUploadQueue,cancelUpload:d.cancelUpload,retryUpload:d.retryUpload}}});define("mediaServices",["lodash","mediaServices/services/wixMediaManager/adapter","mediaServices/services/fontsManager/fontsManager"],function(a,b,c){"use strict";function d(){this.mediaData={siteMediaToken:"",isEmailWithWixDomain:false};this.fontsManager=c;this.mediaManager={manage:b.manage.bind(null,this.mediaData),open:b.open.bind(null,this.mediaData),presets:b.presets,categories:b.categories}}d.prototype=a.create(Object.prototype,{constructor:d,setSiteMediaToken:function(a){this.mediaData.siteMediaToken=a||""},setIsEmailWithWixDomain:function(a){this.mediaData.isEmailWithWixDomain=a},getSiteMediaToken:function(){return this.mediaData.siteMediaToken}});return d});